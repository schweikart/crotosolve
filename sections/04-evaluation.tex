\chapter{Evaluation}
\label{chap:evaluation}

To evaluate the quality of the algorithm proposed in chapter
\ref{chap:gradient-free}, we implement a proof-of-concept optimizer.
We compare our optimizer to a number of other optimizers frequently used in QML
by creating a loss curve benchmark for all optimizers.
The benchmark features parameterizable quantum circuits with various degrees of
expressibility and from various research applications.

\section{Proof of Concept}
To put the approach proposed in chapter \ref{chap:gradient-free} to test,
we implement a proof-of-concept application with PennyLane
\cite{bergholm_pennylane_2022}.
PennyLane is a popular \cite{unitary_fund_team_results_2022} quantum computing
SDK with extensive documentation and a number of QML optimizers already
implemented.
Particularly, PennyLane is currently the only quantum SDK to implement the
\texttt{Rotosolve} optimizer, to which we want to compare our optimizer in
section \ref{sec:optimizer-comparison}.

While the circuits we want to optimize can be composed of arbitrary static
(i.e., non-parameterized) gates, we limit the types of parameterizable gates to
rotational pauli gates and controlled rotational pauli gates.
Additionally, we assume all parameters are independent from each other and used
without any preprocessing (e.g., having a $RP(x^2)$ gate for a parameter $x$).
% TODO comment on whether this is an actual limitation?

For our algorithm to work, we also need to know which parameters belong to which
type of parameterized gate.
As a simple solution, we assume all $RP$ parameters are passed as an array
separate from the $CRP$ parameters array.
It is in theory, however, also possible to detect the type of gate through static analysis
of the circuit, which is beyond the scope of this thesis.

Similar to the \texttt{Rotosolve} algorithm \cite{ostaszewski_structure_2021},
our \texttt{Crotosolve} implementation optimizes each parameter individually.
Each parameter corresponding to an uncontrolled rotational pauli gate can be
optimized following the exact approach presented by Ostaszewski et al..
And for each parameter corresponding to a controlled rotational pauli gate, we
first reconstruct the univariate cost function (see section \ref{sec:constants})
and then use a numerical optimizer to find the minimizing parameter value (see
section \ref{sec:minimization}).
The algorithm pseudocode is stated in listing \ref{alg:crotosolve}.

\begin{algorithm}
    \caption{The \texttt{Crotosolve} algorithm updates parameter individually}
    \label{alg:crotosolve}
    %
    \SetKwFunction{ReconstructCrp}{ReconstructCrp}
    \SetKwFunction{RotosolveUpdate}{RotosolveUpdate}
    \SetKwFunction{MakeUnivariate}{MakeUnivariate}
    %
    \KwData{$prev\_params \in \mathbb R^n$, $circuit$}
    \KwResult{$params \in \mathbb R^n$}
    \BlankLine
    $params \gets copy(prev\_params)$\;
    \For{$p \gets 1$ \KwTo $n$}{
        $uni \gets $ \MakeUnivariate{$circuit$, $params$, $p$}\;
        \eIf{$p$ belongs to controlled gate}{
            $recon \gets $ \ReconstructCrp{$uni$} \Comment*[r]{see section \ref{sec:constants}}
            $next\_params[p] \gets \underset{x \in [0, 4\pi]}{\operatorname{argmin}}\, recon(x)$ \Comment*[r]{using numerical minimizer}
        }{
            $next\_params[p] \gets $ \RotosolveUpdate{$uni$}\;
        }
    }
\end{algorithm}

\section{Optimizer comparison}
\label{sec:optimizer-comparison}

\begin{itemize}
    \item mention which circuits we compare \cite{sim_expressibility_2019}
\end{itemize}

% TODO explain why not just extend Rotosolve

\section{Outline}
\begin{itemize}
    \item
        Evaluate the accuracy of the model, the number of steps in the
        optimization loop and the number of circuit evaluations
        \cite{wendenius_gradient-free_2023,ostaszewski_structure_2021}.
    \item
        Compare the results with the performance of other established
        optimizers (e.g., Adam \cite{kingma_adam_2017}, Gradient Descent and
        Quantum Natural Gradient \cite{stokes_quantum_2020}) as well as the
        \emph{Sine Exact} and \emph{Sine Iterative} variants proposed in
        \cite{wendenius_gradient-free_2023}.
        % TODO: sources for other optimizers
        For this purpose, evaluate at least the circuits from
        \cite{sim_expressibility_2019} that were also evaluated in the
        Wendenius et al. paper \cite{wendenius_gradient-free_2023}.
        % TODO: more circuits to evaluate? eileen might have access to
        %       something...
    \item
        Think about the effects of barren plateaus on this optimizer.
        % TODO: do think about this and come up with a concrete task!
        % TODO: cite barren plateaus
\end{itemize}
